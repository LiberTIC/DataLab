#{extends 'main.html' /}
#{set mainClass:'organisme search' /}
#{set title:messages.get('page.organisme.search.title') /}

<div class="firstBlock blockDefault mainContainer">
    <div class="container">
        <h1>&{'page.organisme.search.title'}</h1>

        <div id="searchIntro">
            #{cms.display 'annuaire_search' }
                <p>Cet annuaire collaboratif répertorie les acteurs de l'enseignement, la recherche, les aassociations, réseaux, médias et entreprises proposant des services et outils en lien avec les démarches open data et le traitement des données en Pays de la Loire.</p>
            #{/cms.display}
        </div>

        <p>&{'page.organisme.search.accroche'}</p>

        <div id="new">
            <a class="btn btn-primary" href="@{Organismes.edit()}" title="Créer une fiche acteur">&{'page.organisme.search.create'}</a>
        </div>
    </div>
</div>


#{form @Organismes.search(), id:'form', method:'GET'}
    <div class="blockDark">
        <div class="container">
            <div class="row-fluid">

                <!-- Right column -->
                <div class="span8">
                    <div id="search">
                        <h2>&{'page.organisme.search.search'}</h2>
                        <div class="row-fluid">
                            <div class="span2">
                                <label id="query" class="control-label pull-left">&{'page.organisme.search.keyword'}</label>
                            </div>
                            <div class="input-append span10 pull-right">
                                <input id="query" type="text" name="query" value="${query}" />
                                <button class="btn btn-primary" type="submit"><i class="icon-search"></i></button>
                            </div>
                        </div>
                    </div>

                    <div id="result">
                        #{list items:organismes , as:'organisme'}
                            #{organisme organisme:organisme.getLastVersion(), as:'list' /}
                        #{/list}
                    </div>
                </div>

                <div class="span4">
                    <h2>&{'page.organisme.search.search.target'}</h2>

                    <div>
                        <h3>&{'page.organisme.search.typo'}</h3>
                        <div class="blockDefault">
                            <ul class="unstyled">
                                #{list items:types, as:'type'}
                                    <li>
                                        <label for="type${type.id}">
                                            <input id="type${type.id}" name="typologies" type="checkbox" value="${type.id}">
                                            ${type.libelle}
                                        </label>
                                    </li>
                                #{/list}
                            </ul>
                        </div>
                    </div>

                    <div>
                        <h3>&{'page.organisme.search.departement'}</h3>
                        <div class="blockDefault">
                            <ul class="unstyled">
                                <li>
                                    <label for="44">
                                        <input id="44" name="deps" type="checkbox" value="44"> &{'page.organisme.search.44'}
                                    </label>
                                </li>
                                <li>
                                    <label for="49">
                                        <input id="49" name="deps" type="checkbox" value="49"> &{'page.organisme.search.49'}
                                    </label>
                                </li>
                                <li>
                                    <label for="53">
                                        <input id="53" name="deps" type="checkbox" value="53"> &{'page.organisme.search.53'}
                                    </label>
                                </li>
                                <li>
                                    <label for="72">
                                        <input id="72" name="deps" type="checkbox" value="72"> &{'page.organisme.search.72'}
                                    </label>
                                </li>
                                <li>
                                    <label for="85">
                                        <input id="85" name="deps" type="checkbox" value="85"> &{'page.organisme.search.85'}
                                    </label>
                                </li>
                            </ul>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
#{/form}

<div class="blockDefault" id="export">
    <div class="container">
        <div class="row-fluid">
            <!-- Right column -->
            <div class="span8">
                <a class="pull-right" href="@{Organismes.csv()}" title="&{'page.organisme.search.export'}">
                &{'page.organisme.search.export'}<img src="@{'public/images/pictos/csv.png'}" alt="" />
                </a>
            </div>
            <!-- Right column -->
            <div class="span6">
            </div>
        </div>
    </div>
</div>

#{set 'moreScripts'}
    <script type="text/javascript">
        $(document).ready(function() {
            $(":checkbox").click(function(){
                $("#form").submit();
                $(":checkbox").attr("disabled", true);
            });
        });
    </script>
#{/set}